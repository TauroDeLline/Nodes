#!/bin/bash

# Имя контейнера
container_name="Sonaric"

# Образ Docker
image_version="ubuntu:22.04"

# Проверка, существует ли контейнер с таким именем
if [ $(docker ps -a -q -f name="^${container_name}$") ]; then
  echo "Контейнер с именем $container_name уже существует. Удаляем его..."
  docker stop $container_name >/dev/null 2>&1
  docker rm $container_name >/dev/null 2>&1
  echo "Контейнер $container_name удалён."
fi

# Создание и запуск контейнера
echo "Создаем и запускаем контейнер..."
docker run -d --name $container_name $image_version sh -c "$(curl -fsSL https://get.sonaric.xyz/scripts/install.sh)"

# Проверка запуска контейнера
if [ $? -eq 0 ]; then
  echo "Контейнер $container_name успешно создан и запущен."
else
  echo "Произошла ошибка при создании или запуске контейнера. Проверьте настройки."
  exit 1
fi

# Вывод логов контейнера
echo "Отображение логов контейнера (нажмите Ctrl+C для выхода):"
docker logs -f $container_name
